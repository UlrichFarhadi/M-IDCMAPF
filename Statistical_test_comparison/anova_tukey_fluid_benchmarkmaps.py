import matplotlib.pyplot as plt
import networkx as nx
import sys
import os
import random
import copy
from typing import List
import itertools
import numpy as np
from dask.distributed import Client, LocalCluster
from dask import delayed
from dask import compute
import csv
import ast
from tqdm import tqdm
from scipy import stats

# Self made imports

# Get the path of the current script
script_dir = os.path.dirname(os.path.abspath(__file__))
# Add the parent directory of the current script to the Python path
parent_dir = os.path.abspath(os.path.join(script_dir, '..'))
sys.path.append(parent_dir)

from Map.map import Map
#from Map.map import * # Dårlig kodeskik at importere en hel fil
from Agent.agent import Agent
from Agent.IDCMAPF_agent import IDCMAPF_agent
from Swarm.swarm import Swarm
from Swarm.swarm_IDCMAPF import Swarm_IDCMAPF
from Renderer.renderer import Renderer
#from Renderer.renderer_pygame import Renderer as Renderer_Pygame
from Simulator.simulator import Simulator
from IDCMAPF_Tests.tests import * # Dårlig kodeskik at importere en hel fil
from Logger.logger import Logger
from GA.GA_Rules import GA_Priority_rules
from generate_start_and_target import generate_start_and_target_to_list, generate_start_and_target_from_scenario

def environment_func(rule_order, chromosome, start_position, target_position, env, amount_of_agents = 10, agent_type=IDCMAPF_agent,  delay=0.0001, fig_size_factor=20, node_size=10, linewidth=0.5, dpi=40 , display=False, max_timestep=1000):
    # Create the map object
    map = Map_directed()
    map.generate_map(env)
    if len(chromosome) != 0:
        map.update_weight_on_map(chromosome)

    swarm = Swarm_IDCMAPF(map, amount_of_agents = amount_of_agents, agent_type=agent_type, rule_order=rule_order)
    renderer = Renderer(map, delay=delay, fig_size_factor=fig_size_factor, node_size=node_size, linewidth=linewidth, dpi=dpi)
    simulator = Simulator(map, swarm, renderer, display=display, max_timestep=max_timestep, positions_for_agents=[start_position, target_position])
    return simulator.main_loop()

def run_experiment(times, rule_order, chromosome, startpos, targetpos, environment, agents_amt):
    list_of_cost = []
    list_of_makespan = []
    for i in range(times):
        cost, makespan = delayed(environment_func, nout=2)(rule_order=rule_order, chromosome=chromosome, start_position=startpos[i], target_position=targetpos[i], env=environment, amount_of_agents=agents_amt)
        list_of_cost.append(cost)
        list_of_makespan.append(makespan)
    res = compute(*list_of_cost, *list_of_makespan)
    failrate = 0
    for span in res[times:]:
        if span == 1000:
            failrate += 1

    return res[:times], res[times:], failrate # returns cost, times

def read_my_file(filename):
    with open(filename, 'r') as csvfile:
        reader = csv.reader(csvfile)
        data = []
        for row in reader:
            row[0] = ast.literal_eval(row[0])
            data.append(row)
        return data

def main():
    cluster = LocalCluster()
    client = Client(cluster)
    print(f"Link to dask dashboard {client.dashboard_link}")

    for num_agents in [200]:
        #num_agents = 600
        num_experiments = 25
        # num_repetitions = 25
        #env_name_direct = "empty-10-10"
        env_name_direct = "random-32-32-20"
        env = "Environments/" + env_name_direct + ".map"
        chromosome = [1, 0.6372292973337423, 0.5870591334818055, 0.8543617295957026, 0.776763844896579, 0.6144644777951984, 0.41074100566688543, 0.4225538153921017, 1, 0.1355821477200515, 0.40949788374825485, 0.40814358365121967, 0, 0.6383737608184781, 0.3014376098870697, 0.7598007606203446, 0.32170537758851914, 0.05479049006266524, 0.19821050227992584, 0.5295184995961704, 0.7335186908903479, 0.7089749439452664, 0.4170215098700998, 0.005718542679829561, 0.8473521737769716, 0, 0.20669546128602234, 0.009038087806890013, 0.32233676560215085, 0, 0.05183734162975431, 0.6585215187811424, 0.16737441697040448, 0.4478299874500713, 0.3344747430904661, 0.28968220289639424, 0.7426872042117338, 0.7640642354357002, 0.7146388489097877, 1, 0.6729125612373604, 0.7963532254066413, 0.08774722710791034, 0, 0.5050291294834942, 0, 0.6566309362452791, 1, 0.11380699316416924, 0.3768220298416451, 0.5148132345191765, 0, 0.7174093245841618, 0.6018744319600986, 0.38316614614419797, 0.6389456888993569, 0.05279580277853796, 0.4226674934493597, 0.6709167329366421, 0.32504991867697164, 0, 0.554735077812901, 0.39630632609800476, 0.3163246402236625, 0.26637882249096567, 0.43297757618765165, 0.7886805225321052, 0.8061125642569597, 0.34110705739598174, 0, 1, 0.923639710545364, 0.717930838453937, 0.27935300339041624, 0.8955727455275038, 0.543651040686959, 0, 0.727902156771079, 0.35396633500891506, 1, 0.2780917368794009, 0.9946791835650901, 0.3565617106244273, 0.31155189111628884, 0.5590652624178858, 0.00821488870964207, 0.3296579665950093, 0.24913943820610143, 0.9893952080509081, 0.41357139906200163, 0.9517242223015271, 0.04593993684905012, 1, 0.585614960289948, 0.4006927571823124, 0.530616098109614, 1, 0.3537534721137406, 0.10789497772805881, 0, 0.22594404028458945, 1, 0.3707939224736985, 0.5500005841960127, 0.07779867910848937, 0.5983312857203475, 0.13153057937572793, 0.523630507512769, 1, 1, 0.27630548513777514, 0.03637302111009158, 0.6313440762421179, 0.532464877054163, 0.8163480687500948, 0.5772867308416582, 0.37931766467920436, 0.004676451555591626, 0.4357165521655537, 0.17833739884983876, 0.8539671793041176, 0.3635854834716973, 0.30038252723761694, 0.026618639890508, 0.5349187641615419, 0, 0.4747869143387127, 0.9932628481252707, 0.013791494464710119, 0.82685145163043, 0.15488417292802095, 0.3952178834543868, 1, 0.3024107796613222, 0.12459081913421549, 0, 0.1559388167906811, 0.6693373696823848, 0.3025819814024406, 1, 0, 0, 0.22847511943998058, 0.6754188458745572, 0.46998647749557526, 0.6182492711147518, 0.03498013200400384, 0.9453013697966745, 0.7158043164896479, 0.14764804173177778, 0.17266071663844373, 0.2559881384283983, 0.517365490595473, 0, 0, 0, 1, 0.8953534006609126, 0.3317655078637246, 0.4744740564640081, 0.830510857244529, 0.5704546427989123, 1, 0.23344523038827858, 0.4911985040952851, 0.4478891855338261, 0, 0.23862580687757665, 1, 0.14183264675882484, 0.6565288824884, 0.4675667622201853, 0.02896724424737482, 0, 0.372049164235927, 0.18214470998028046, 0.5956490823120811, 0.8175010545153263, 0, 0.5388030334089456, 0.40631491107063994, 0.8880417711676869, 0.44216631174497334, 0.02286314940096651, 0.9775539278169413, 0.29204542855146715, 0.5789374441675151, 0, 0.18275221817014814, 0.933097830832846, 0.014178461374309451, 0.2808416143636921, 0.8456783571424067, 0.10365042233609074, 1, 0.7314630439480618, 0, 0.13529817309031045, 0, 0.13775950761455355, 0.735466918684579, 1, 0.18875047488585756, 1, 0.7638082268938193, 0.9721563731925917, 0.31970907536734644, 0.697812808232586, 0, 0.6443398756217474, 0.276707298775413, 0.7181467410640383, 0.4869374587854544, 1, 0.5475429706817313, 0.3366292983308313, 0.5168778265622336, 0.2577424188744959, 0.8043402395176062, 0.45889869992035137, 0.7015700028108924, 0, 0.9132282503576372, 0.8022443576005331, 0.6602066649893861, 0.7601300822633316, 0.4329412915803626, 0.5266780855420605, 0.8848048432263804, 0.7464866329461832, 0.14503240896937084, 0.7358896629847475, 0.5234790581264521, 0.8431507917760611, 0.3512049231688335, 0.08392632887581009, 0.3497811708994684, 0.5575931642447091, 0.9356786425847139, 0.8258742683012468, 0.4938709450122168, 0.6321652621076832, 0.5591752921660058, 0.45493112254641827, 0.7924061369745468, 1, 0.018656852987939888, 0.2797944342897602, 0.21829881059465545, 0.07834411320765, 0.56766782183946, 0.3581405143663275, 0.7299644007637694, 1, 0.9082843342390537, 0.21671799099600625, 0.3610677232059802, 0.796275997107259, 0.9527630867048894, 0, 0.9872170696864041, 0.9494708304589242, 0.6071235075635465, 0.1843022757942155, 1, 0.6848092080077941, 0, 0.675582966321916, 0.44260323237716903, 0, 0, 0.7498934146872015, 0.04065375135647624, 0.5075956378212064, 0.24011875496109578, 0.4045257489409969, 0, 0.5711046467499106, 0.9383255515170567, 0.10968636514078536, 0.35258323091734634, 1, 0.47305171665309725, 0, 1, 1, 0.45594004753324924, 1, 0.25907263153625776, 0.38620796679755914, 0.1741637492208982, 0.10647020644835668, 0.4998533613381112, 0.3487266570515382, 0.8417458147141545, 0.453843235126106, 0.2864163547948344, 0.7606862251803874, 0.2631725518038198, 0.6210599108639901, 0.4638827064834191, 1, 0.8887200162279385, 0.19368395698020174, 0, 0.40953745647687007, 0.3099270337518275, 0.0328500246210969, 0.35058172088101724, 0.3504475209828182, 0.12403158854480933, 1, 0.6487149350014461, 1, 0.2522828159940077, 1, 0.032805839336131216, 0.2567339650497347, 0, 0.899304098888243, 0.9897318511161897, 0.5884644762636382, 0.10411940617225848, 0.5825651697155317, 0.7389732516693878, 0.5042020054070169, 0.855410262772909, 0.9985331371626436, 0.24840126024297066, 1, 0.05554877153109536, 0.9565750463131523, 0.32910527357656727, 0.05376781272246711, 0, 0.04052792640661864, 0.2238709903311049, 0.507090643542478, 1, 0.6850198482177992, 0.9630565095171296, 1, 0, 0.8720638453049259, 0.5000109730318847, 0.9181283734843427, 0.8767086954291508, 0.527169539139305, 0.2377934643675385, 0.2330491055149748, 1, 0.6752474168874033, 0.2393847396474583, 0.847546618278574, 0, 0.09439046850004157, 0.7379673661969112, 0.39162479209598783, 0.28481104088773235, 0.0765494036812629, 0.18331000659017382, 0.31838385137165104, 0, 1, 0.7859902573690656, 0.7745807550397541, 0.47668670939990077, 0.49618802026685616, 1, 0.016585816353776713, 0.06811303144865274, 0, 0.6710419396853539, 0.35967948910792213, 0, 1, 0.665950821757842, 0.747581388219067, 0.4392433517899447, 0.8441100093747793, 0.803182758751414, 0.8946774466009363, 0.12713953005363593, 0.08461423450878712, 0.9897237536106501, 0.37825045432980764, 0.34811096065839464, 0.061402537789202405, 0, 0.5454233142298588, 0.49070250709115304, 0.3064302502337186, 0.6723014906917801, 1, 0.23574206178144927, 0.7416958606336894, 0.2272734011721657, 0.6032266520768804, 0, 0.9006090796954087, 0.25422622957755925, 0.899346346051952, 0.9559513385616535, 0.2945264920599915, 1, 0.6491296130337467, 0.17444408528909344, 0.17132791203092596, 0.5256237278978338, 0.18566645087142924, 0.7997240516423562, 0.7448138782015491, 0.5821473313042222, 0.49852514490289446, 0.8999207689900085, 0.08515779267432363, 0.42029016216872717, 0.4225748581415476, 0.36255032376506496, 0, 0, 0, 0.33286986463621054, 0.7106402767939918, 0.4165103028645698, 0.4754450901304344, 0.6890812200149351, 0.28183433912654554, 0, 0.053917487085965374, 1, 0.8405315290202242, 0.1192532382538741, 0.2764409830863692, 0.4845756947154884, 0.9842611435236697, 0.36800953799489583, 1, 0.35628375095585163, 0.4141708445540431, 0.8134912492394447, 1, 0.35681599366032135, 0.02160001144568463, 1, 0.5559801525119915, 0.18019032575546562, 0.557324232263324, 0.06517660244701914, 1, 0.6419672429758616, 0.6138045299659982, 1, 0.7269158512700107, 0.7200890271548703, 0.11902262617864462, 0.5574876398897969, 0.2968520593857998, 0.6707611059299023, 0.4353689573045598, 0.42428095282814904, 0.33902542972550304, 0.21485223627937244, 0.6579720298387144, 0.23483060512868376, 0.7039914572764242, 0.1761159235815521, 0.15651228305915968, 0.48611880020331644, 1, 0.1201305169672241, 0.08581226932043665, 0.6026772655819067, 0.6647516181365585, 1, 1, 0.28612843482616107, 0.535704730367056, 0.8518607421780569, 0.015939362741509533, 0.38203482075386525, 0.025584725276579443, 0, 0.517743929598089, 1, 0.39293535693718834, 0.3108588586236167, 0.9224854372611551, 0.46360797112730656, 0.062257612319424414, 0.8224921314849022, 0.368442613962265, 0.43198548050179897, 0.2507906623477626, 0.37979175756014094, 0, 0.2884221413496704, 0.40397985391271996, 0.662732798152144, 0.6658897914150071, 1, 0, 0.41091682352431885, 0.13269985800125056, 0.47695586161775744, 0.9054539863871631, 0.7051929611757005, 0.7970079965094153, 0.4047143871440626, 0.5613145672964694, 0.7826938566806243, 1, 0.8432682996043389, 0.9562338700592844, 0.1380902309265723, 0.5831081987261622, 0.40072588776924434, 0.7812922280471271, 0.23931735711023755, 0.7097558505692422, 0.4839939172408551, 0.6845017922229837, 0.08944678056376865, 0.7409246980976891, 0.418047223294798, 0.6733750188505724, 0, 0.25582624531529286, 0.6532980262866203, 0.4785626738168547, 0.6298345526474198, 0.031024826058260183, 0, 0.5926206949017553, 0.31308081719305236, 1, 0.8190257930377657, 0.2584112221651529, 0.3270705848397506, 0.8775595994441602, 0.9601381274685287, 0, 1, 0.4763631157866308, 0.8917751573661323, 0.577417540213148, 0, 0.4912100898490375, 0.09200508179542001, 0, 1, 0.13141453537836115, 1, 0.522656913787149, 1, 0.5315448556783299, 0.9083892305570802, 0.48710950119339314, 0, 0.3388257959131877, 0.6198605179860123, 0.2604683218105054, 0.8415868625107974, 0.21145805728761952, 0.5224311299347367, 1, 0.49675966812354, 0.5235987220101893, 0.42400075513314583, 0.5569123850862295, 0.4822638438893694, 1, 0, 0.31407559121354583, 1, 0.8099915079527344, 0.6857896214157384, 0.6720624980122587, 0.6728880151296266, 0.20462440794520254, 0.7982731559633705, 0.7723862153874427, 0.9330116939393036, 0, 0.1328657392578108, 0.48358551481386997, 0.11501271859038378, 0.4750843025501617, 0.10560760999279958, 0.14375505265320632, 0.04411169597371685, 0.282265662255944, 0.7917866565746086, 0.7032122468512892, 0.4164028035289151, 0.7069855662494768, 0.020284606992535432, 0.24309234078850972, 0.7575947722074475, 0.16475731804824648, 0.028559134844471146, 0.532125630468526, 0.6993978450799, 0.20183505438666208, 1, 0.1353802616244677, 0.2691189777590022, 0.9340220192537846, 0.7090129578163304, 0.9002474015673207, 0.3452850613004084, 1, 0.9014318128222343, 0.7264748557252841, 1, 0.6462317489247098, 0.24951077622235657, 0.9525116806246358, 0, 0, 0.5051198729592192, 0.9660050469523784, 0.29280115007635277, 0.7846909392211896, 0.673371025989568, 0.008775059553350145, 0.5329718378477977, 0, 0.9253956287969929, 0.07912688515866251, 0.7297199200040184, 1, 0.16995458770087785, 0.41693871090570694, 1, 0.0745418762859264, 0.5275015719566275, 0.5547063328474445, 0.3707239762434334, 0.666467228321921, 0.3548689920298993, 0.31816164896475807, 0.6531167182066175, 0.7319874973446419, 0.41262715742208944, 0.49316499016575854, 0.1704593511873242, 0.1644534046422669, 0.9893444590377483, 0.7817027394664025, 0.6009239179723456, 1, 0.4598173271393719, 1, 0.17595544147442063, 0.45362591990131307, 0.9632304692401659, 0.07272539021103275, 0, 0.6561092191308522, 0.934765940004528, 0.17245230748450946, 0.1970987774942325, 0.39535959059281245, 0.5302872282401258, 0.9408417627804818, 0.11030215081497681, 0.9704678708666351, 0.41782054847008404, 0.3026615042200272, 0.25163550940767837, 0.8301760066688366, 0.25497061705939883, 1, 1, 0, 0.6415864044845625, 0.5805807168998554, 0.6881207135892147, 0.9913514406390294, 0.20575150867802844, 0.673656484323639, 0.6807376114963244, 0.3352515999189635, 0.36932883548971185, 0.5423113426820608, 0, 0.7823708807694076, 0.8994457490223933, 0.3339026031544685, 0.9767223536114598, 1, 0.5486205052017306, 0.7245129988503115, 1, 0.26445466487954716, 0.5033118736759727, 0.48182550881951014, 0.7192257304895805, 0.45620415380785906, 0.5976473931648245, 0.22505461815614766, 1, 0.9852904171675834, 0, 0.12976343567093532, 0.7497006768576229, 0.08466130214638307, 0.28623455798622227, 0.6414632650647435, 0.2826460293710089, 0.7138934925661498, 0.34994371391964807, 0.7942155000896115, 0.06957872909432644, 1, 0.5835664266089536, 0.6196458993711778, 0.030642353021316814, 1, 0.7429909930127883, 0.8283188671025629, 0.36034833548169704, 0.27165026191569086, 0.2605349203535205, 0, 0.19285050342091595, 0.27810788082893056, 0.6515007343445006, 0.6595983935107638, 0.21006721034149528, 0.19781024311271692, 0.0031080029605544367, 0.35776951465017265, 0.690791908170366, 0, 0.8996805327726827, 0, 0.5735814218434911, 0.17899497085223914, 0.1104512094392272, 0.1263878667729171, 0.4235618095530657, 0.45588240953087533, 0.7431933702959208, 0.0020246280379815932, 0, 0.7112181131615055, 0.6379805371511132, 0.05512664941225055, 0.3716156553763736, 0.07712329221928217, 0.7274527180115855, 0.07908119535579938, 0.5794624973946477, 0.9206760399922131, 0.9851762625919007, 0.2597644541717232, 0, 0.17482077184575864, 0.4735164901712303, 0.3944516392401777, 0.8662785002192868, 0.14707376135646297, 0.4316881925799275, 0, 0.891149196771763, 0.3236591932439316, 1, 0.7634898890980073, 0.3883248676180124, 1, 0.5740268962654974, 0.3037963968888369, 0, 0.5208656073908948, 0.38882146228282055, 0.48351334565472665, 0.8230816787527265, 1, 0.9112547595444855, 0.5198218741191549, 0.7930279648511643, 0.7003326254320072, 0.9872704054792965, 0.16882463063209752, 0.8916813951481524, 0.8056148325964749, 0.9725387542836288, 0, 0.47098948296424653, 0.23218692328332904, 0.29568638329258035, 0.9801193994100453, 1, 0.7043241735689868, 0.11298781378797267, 0.3297550737184947, 0.6271681517379455, 0.2822780496404616, 0.47393370938950335, 0.8020546584481113, 0.4873292031348327, 0.04844461298332893, 0.82115564694862, 0.5220252919782502, 0.8346271833943788, 0.13094696507351747, 0.24176118152393117, 0.18691296604297858, 0.32031759607039045, 1, 0, 0.5304762134646973, 1, 0.36689461807357465, 1, 0.2891219413426171, 0.31829479213867734, 0.31034490689998595, 0.6067890115047039, 0.9821100558237161, 0.09490666004651863, 0.03160594012177657, 0.07026847827445082, 0, 1, 1, 1, 0.5036896619665143, 0.7909731350722125, 1, 0.4901715012216593, 0.5886265992374761, 0.1581982581411454, 0.622162679796178, 0, 0.27651400407255405, 1, 0.7455474972431657, 0.32027698228306173, 0.8202323197047683, 0.7116474928600514, 0.44771231006968887, 0.7164115143514592, 0, 0.7577645424294617, 1, 0.5492154624199211, 0.5161873814822842, 0, 0.4690300030853946, 1, 1, 1, 0.5309829309902911, 0.9047559016432674, 0.2117886449975071, 0.5299019948233116, 0.6693737354354645, 0.8484039124776019, 0.22289949547335527, 0.7719823969617134, 0.146137932338501, 0, 0.506746092736608, 0, 0.7567872927235755, 0.09756346505610003, 0.03768366551443284, 0.13167752861448126, 0.9865802249508908, 0.8277429642253429, 0.88110485253268, 0.20802126281956032, 0.904507480891538, 0.48111305311954994, 0, 0.547397926156055, 0.041356161461040486, 1, 0.6281301754556771, 0.17226019856198999, 0.9091832979510868, 0.26113124843545, 0.9826371022420918, 0.8629195726720484, 0.6875043245626675, 0.656872910032969, 0.9124022612239855, 0.5324000662387751, 0.7817837518017995, 0.8812263797595623, 0.07152792730405033, 0, 0.5756887421363686, 0.37246172721009047, 0.7963070463732137, 0.16080855480419237, 0.7014011857509077, 0.12549230526415603, 0.8018619308235895, 0.678304584462161, 0.18448762055612, 0.2812486474750542, 0.6059589248305062, 0.8335932411542297, 0.30496363166599233, 0.1818428242016667, 0.26227245426505913, 0.9349992292139411, 0, 0.662973825130831, 1, 0.7109412648760729, 0.893116842741179, 0.4149376048672859, 0.6133404842881331, 0.4474455484799128, 0.14559072498925685, 0.4808832884492875, 0.4052284368603727, 0, 0.9595629418184608, 1, 0.7023302104635524, 0.6351999446921518, 0, 1, 0.4818293914172598, 1, 0.5042309101227744, 0.7341597100402439, 0.9593841734600871, 0.39083810803345337, 0.9622736914698646, 0.41278354980181053, 0.6932802530599607, 0, 0.745528970511666, 0.013733801584101674, 1, 0.36892832608100984, 0.5917132110247642, 0.12632444042182267, 0.6286695679950607, 0.4738490601084739, 0.41296101364609994, 0.049281219994710274, 0.46518612912416957, 0.6753454821006736, 0.6342801991103859, 0.7076673549217379, 0.6614477455146314, 0.7558045774186466, 0.42599394792431, 0.5363707468956262, 0.6014796998158608, 0.17531393735180367, 0, 0.07216902143892635, 0.6848006165294565, 0.4767517194462381, 1, 0.7340778853923163, 0.752634724184435, 0.7771734488464157, 1, 0.7853788507082099, 0.19377092689706726, 0.6103558292486281, 0.35443961252614, 0.6095907384822092, 0.5431778543177225, 0.6421112363955597, 0.7169187324857894, 0, 0.2484889523959966, 0.1493813421081458, 1, 0.0019183540342619812, 0.3818860315873315, 0.2635560745380793, 1, 0.9438655822249317, 0.05288833857914166, 0.6365413212836754, 0.9120604043390279, 0.3628443115855525, 0, 0.8558958079397736, 0.011846018832986874, 0.15056913968446867, 0.446249998594111, 0.542758697534131, 0, 0.9944295125531887, 0.474193453420887, 0.48351741667150827, 0.5357993662016005, 0.4314200178863459, 0.8545262520228726, 1, 0.5644625919858238, 0.8490752628055084, 0.2766232811128329, 0.46370363446219653, 0.7665291651526769, 0.8866297973642774, 0.3844354985876459, 0.28960857670729667, 1, 1, 0.9574455451138502, 0.24047480471757404, 0.830948987577205, 1, 0.5415227590951133, 0.6156445782206668, 0, 0.16999617425177446, 0.9064678853867206, 0.23727235395547813, 0.016627201142583488, 1, 0.4982439916583891, 1, 0.8195613659271994, 0.3432113989984146, 0.40833637364407693, 0.841201725098975, 1, 0.5642914279313591, 0, 0.4003721320577153, 0.15984647129777083, 0, 0.6452608636096737, 1, 0.7286578384509577, 0.45532069082273385, 0.44265454231715307, 0.35074421478221784, 0.10436854163767863, 0.6632831907713823, 1, 0.587618114791402, 0.6542283282997469, 0.7006067038408857, 0.9456280690673258, 0.5601259189418694, 0.20700958712385942, 0.39475436479446724, 0.3628724809391273, 0.02579646797498175, 0.68104457424734, 0, 0.4995922838869725, 0.9234483247399659, 0.46571655717276417, 0.24681164352832288, 0.4377012681274931, 0, 0.9725515338278665, 0.02025566972499446, 0.5623420350928855, 0.5211573343107428, 0.2786308701093341, 0.6342848481542511, 0.015175077067701558, 0.1819362747377046, 0.20979307529513758, 0.9749171445696942, 0.6351268426680441, 0.7564653128858152, 0.8983855545337327, 0, 0, 0.32788292796580226, 0.1751680994141099, 0.005434137122631633, 0, 0.9318402432336174, 0.7535571227431305, 0.8015350628388086, 0.7563130178489967, 0.16053754365600223, 0.6496559754655359, 0.5005171917253666, 0.6729668721354052, 0, 0.7265377007858635, 0.5405026791684682, 0.6645296240564056, 0.5453889349031842, 0.3650669693692698, 0.09057080346428278, 0.6421013852928544, 0, 0.2596328780668781, 0, 1, 0.19109284570161217, 0.5732503350801398, 1, 0, 0.7786278967930734, 0.24055181026633732, 0.3776145175083421, 0, 0.5157628598343252, 0.41372484804456805, 0.5668139875697089, 0.05052428922302569, 1, 0.9573475038518614, 1, 0.25300324862792034, 0.16905407346707446, 0.6151988787631594, 0.8628473111286556, 0.22470476645703868, 1, 0.30002725010433995, 0.31776534397872513, 0.5362199814791722, 0.5338921211319085, 1, 0.414712352854821, 0.8177387777470068, 0.5078219151679105, 0.3709480913175519, 0.5314635786767713, 0.11031045553682182, 1, 0.1219268833570222, 0.9577891414934996, 0.24260108251438514, 0.4698426034524843, 0.3328287775510626, 0.6584762077744966, 0.23480142050338057, 0.8506199225767608, 0.2168412253654761, 0.7977452287786313, 0.3705898947812188, 0.7749155396572096, 0.2266951234937803, 0.5589847867626162, 1, 0.017369609862054918, 0.5041615544070579, 0.5304209168521644, 0.03335785757253994, 0.5150793011278177, 0.22162648963102208, 0.33515986463425734, 0.7874349647982183, 0.809974804543311, 0.8583902391426268, 0.7333663087789917, 0.9093356982241804, 0.061180887005340114, 0.9488556966720579, 0.6930522046972847, 0.7827651725395386, 0.4581484479383552, 0.9007558102991643, 0.5623975429079219, 0.2265445454136914, 1, 0.1182432305973872, 0, 0.5671202780057555, 0.9956315082059483, 0.30939251623306874, 0.9078019594260285, 0.7812264082235708, 0.419794417097398, 0.8852373887046897, 0.5796771161717188, 0.9623754428107177, 0.7668579885835665, 0.4664914434353007, 0.8218462512203302, 0.5903406299679018, 0.639458051072728, 0.3740399432933146, 0.6215346012252704, 1, 0.44929343338874395, 0.46345414610097146, 0.49635313983619644, 0.08692337179435553, 0.4221201449115303, 0.9299188748754835, 0.47931160077193535, 0.6290868955193526, 0.3729102950492696, 0.13195929994040334, 0.4041482708417233, 0.3851083770006464, 0.17988901430326115, 0, 0.5575468094330067, 0.9117639992076146, 1, 0.8314375177541014, 0.219271184238778, 1, 0.11417110652363621, 0.8441813821535061, 1, 0.9324600220636582, 0.730518186232665, 0.2752200425412489, 0.07898783910894518, 0.3954681418603652, 0.6919074700692105, 0.9651021172657575, 0.656269849508356, 0.30275051415565246, 0.5097614814396675, 0.4985411750484663, 0, 0.7992268282518693, 0.5064207981594727, 0.4712171749225449, 0.8505983703260377, 0.7038858406452925, 0.09847890242555501, 0.3740010337943564, 0.08516940059348549, 0.12335019092894756, 0.43802316281012255, 0.21365107443959536, 0.24175501298328633, 0, 0.5426823559549354, 0.2641880526384829, 0.47991811330651496, 0.6798738766728785, 0.10322988466009565, 0.4111495622539364, 0.3929631857468224, 0.5990065836532924, 0.973881186273304, 0.7278427356495356, 0.5455561968955793, 0.5846309652612061, 0.735122651073636, 0.6840747238905269, 0.7832316484199087, 0.1609699672264726, 0.3777267538377366, 0.6418402390469662, 0.18474139691645614, 0, 0.5098999310238191, 0.4195722791166513, 0.7496016560186608, 0, 0.5207459057856604, 0.38806227017320427, 0.515517070296198, 0.1295904305982367, 0.3112963061983144, 0, 0.30921352726481627, 0.7998454018131769, 0.29638227054544874, 0.3395356747709102, 0.31247975400002903, 0.3861845492499489, 0.6839753202214517, 0.4126286000664933, 0.7702817443958863, 0.2795448379624185, 0.3242748749856116, 0.42435211672142487, 0.35288742254461686, 0.5001777759912953, 0.38547120859644673, 0, 0.9479173978220119, 0.5962285994493527, 0.7590893247969214, 0.4022024495592793, 0.5348813737608411, 0.14492982496783263, 0.3754535353218583, 0.5286183127077435, 0, 0.4319770148825493, 0, 0.9813348544991986, 0.599360654605136, 0.843999708721428, 0.9580511333322586, 0.8456960883500793, 0, 0.04840884782183963, 0.5667862642566888, 1, 0.7416929094791136, 0.402284138179775, 0, 0.23183368788047296, 0.24262416146008847, 0.639707645314023, 0.8182368508708014, 0.2904201298803605, 0.05298813966943443, 1, 0.7701640682696375, 1, 0.5823156354912165, 0.1608896539773086, 0.5013855741152448, 0.8384716541339217, 0.49010485903470946, 0.41224190273878025, 0.02384306341284032, 0.37853016411567914, 0.6144548728774746, 0.9831527072581107, 0.27625842172375353, 0.5147860228722442, 0.6717081122995986, 0.9090236497388505, 0.4633529399391774, 1, 0.2685951833584262, 0.792764987082269, 0.49890521450781267, 1, 0, 0.4690800482508837, 0.4058071774521902, 0.4083450371048061, 0, 0.8702833924732942, 0.17905566602845813, 1, 0.7522870603240913, 0.7744673516735301, 0, 0.2588767983893996, 1, 0, 0.2889763723053026, 0.01935290193349627, 0.7039580218191576, 0.8563265599140055, 0.8841664713157557, 0.6141200581585068, 0.541156848687219, 0.38407150135044954, 0, 1, 0.051225924017482605, 0.6581666046720276, 0.02817898359352839, 0.14361336047580464, 0.799071306407269, 0.37616365157638176, 0.8221142515833177, 0.9277884702934602, 0.5448052730795307, 1, 0.4490323231741855, 0.4061653037522516, 0.6240481769838636, 1, 0.5620249990677174, 0.6026882091520673, 0.15224475562014733, 0.8035895408692834, 0.48219457688029077, 0.8942535166349961, 0.13438907697078767, 0.6012149046263723, 0.6950159845416132, 0.3760105957105472, 0.20694712275702634, 0.8191040637054496, 0.09425646658135489, 0.8034090651977335, 0.9493135076491269, 1, 0.6316681733883354, 0.6397864251783953, 0.9225433943345183, 0.8953726398774013, 0.22280615323909916, 0, 0.371865576562289, 0.5346357721572368, 1, 0.5555998103524487, 0.2280584333485152, 0.39254528336678157, 0.8879371900124665, 1, 0.2572613433372002, 0.10410467486171465, 0.3581496047879895, 0.7170329880166585, 1, 0.34757406515752465, 0.9925883609874028, 0.5671994176173346, 0.011364723446646519, 0.5826958323064657, 0.657655536595032, 0.19559124244581882, 0.2462719976750154, 0, 0.8579542663448476, 0.8764601427505453, 1, 0.34261623179228484, 0.9084640964510611, 0.1574344188009596, 0.9616539029066263, 0.35021465848232114, 0.33974836163883526, 0.8913019920416971, 0.7176018099312311, 0.7697204738935813, 0.7537458955995883, 0.002071745066600736, 0.2982350619951246, 0.18083679995992485, 0.12342970719661817, 0.8113119635223776, 1, 0.7336132737292428, 0, 0.7329873154454245, 0.8989116270987431, 1, 0.527913984565181, 0.26294169915927545, 0.9330722340872502, 0.48504484256879293, 0.2309915862348688, 0.8599419346979749, 1, 0.6002502195828916, 0.8283914431625062, 0.3172733161911396, 0.4960889818302526, 0.6027992381939975, 0.6042703622656888, 0.2089548644873301, 0.8919954473355352, 1, 0.31747926929139864, 0.33062861011307604, 0.6455369511229501, 0.9007822374064135, 0.7824886957039712, 1, 1, 0.30236592155677794, 0.30627657839054834, 0.8079691287721309, 0.7225705037793329, 0.5499379069566354, 0.9812409281371114, 0.23544640258218574, 0.6804451059839534, 1, 0.3693407091948969, 0, 0, 0.5498390690855249, 0.49778159570703845, 0.7117109346747328, 0.6398440960873569, 1, 0.37766316714738396, 0.4062009683582417, 1, 0.319589795831538, 0.7175606615132122, 0.5771571460225666, 0.24108840162247128, 0.2697320154754165, 0.6864008066772798, 0.5087548004740399, 0.6455811781221541, 0.22341153451914025, 0.08728253480533357, 0.5817611764339123, 0.6850300453250775, 0.1403719362485023, 0.5252603258148767, 0, 0.08466919064727407, 0.9635784262636704, 0.3882119566321054, 1, 0, 0.45694255991932814, 0.48467955040475996, 0.1489745532411642, 1, 0, 0.6063914363048735, 0.3946158590507045, 0.7663369680377138, 0.4471080632726141, 0.5360875774744405, 0.6254411979272252, 0.6085965557314363, 0.9262877092390307, 0.27860303847202383, 0.24461108204032564, 0.8633223908902824, 0.7570808389316517, 0, 0.8828043978141449, 0.38564984190618634, 0.824724462014951, 0.8142657360618231, 0.2504518463497374, 0.3082579574730747, 0.9335066192922497, 0, 0.3016431035770827, 0, 0.7677491669679709, 0.8318118547925741, 0.26549669687181215, 0.9041975750143725, 0.9866741823735269, 0.1410903791197202, 0.6123910640198883, 0.09823303818200003, 0.07784741957381007, 0.24984890840591523, 1, 0.9386398366574347, 0, 0, 0.625004189360259, 0.47603995925585185, 0.9484853208404105, 0.21271744975222653, 0.23859705909437848, 0.2584175122320115, 0.860426319229158, 0, 0.7078370448628835, 0.21029522631627506, 0.178943289710973, 0.011665667190187894, 1, 0.3491450268870586, 0.4136302060022144, 0.337795766835656, 0.7527980794435511, 0.5402450197142742, 0.7159704099609273, 0.38404776568951027, 0.8685618451615063, 0.4657322261599149, 0.702710451616257, 1, 0.18694185268964475, 0.6707082964781559, 0.32845442348209153, 0.9506696333915159, 0.07486795084507034, 0.6392691624622419, 0.4078733743462989, 0.7709215420510256, 0.4205444431968912, 0.8013326712941249, 0.3242548085892575, 0.7454443425300956, 0.5181731753156197, 0.22865825859496686, 0.5119248869258273, 0.4347658705804004, 0.44974381564608473, 0.12637031824490433, 0.7713166347048268, 0.2698404037061401, 0.10036292936775051, 0.7257295973152251, 0.25340922906360397, 0, 0, 0.5554382264157067, 0.46205752695441626, 0.6023061012845998, 0.48090047845788253, 0.9629958347325734, 0.7118904067501993, 0.4645030335613177, 0.4215661815729783, 0.7615904574868202, 0.7009410178333397, 0.17105110257696393, 0.33339770789431483, 0.3091090807943552, 0.5488143950655078, 0.8690082033707704, 0.5761973176635178, 0.1981096423273452, 0, 0.02240170654752266, 0.6952239052995334, 0.6172824219321745, 1, 0.4652714280126551, 0.41801551512838153, 1, 0.6164073986378606, 0.785441479797426, 0.7974904163694213, 0.06149280622557268, 0.8900755001279436, 0.7828253637078402, 0, 0.9385557901239434, 0.6959553421623776, 0.2183286082919664, 0.8978923076687453, 0, 0.4532830615058891, 0, 0, 0.6154595850366009, 0.7788919054647725, 0.7840760554289579, 0.4883633589882018, 0.6820335805318841, 0.941749285769928, 0.5701471278603027, 0.7367591181381026, 1, 0.6458485298285438, 0.09241899087749429, 0.30531775598624483, 0.7903932175450731, 0.30646153293209133, 0.7765338707889374, 0.7291779880170691, 0.42393298552038705, 0.8378259550298186, 0.44919575244112525, 0.22171875059577928, 0.603089022750882, 0.9526450201447054, 1, 0.8508873618910887, 0.6113046168695464, 0.8417167064964752, 0.05090016043508302, 0.7790371105063771, 0.356054000640937, 0.14902042793087095, 0.2632762454618971, 0.21003720702775064, 0.9050301563895764, 0.8319199367677994, 0.7109852480818784, 0.8032950154544043, 0.5803881663859467, 0.38102813992803697, 0.2335884082219286, 0.5587083049059721, 0.9570691032823541, 0.6921468487991184, 0.555611625674978, 0.772738202322515, 0.8120174629401143, 0.5271016260843728, 0.6307704781969481, 0.44063590074580566, 0.3889019982142118, 0, 0.7233780865916735, 0.7699236225895014, 0.9986835668808373, 0.5989868423513974, 1, 0.5275209845487726, 1, 0.5289269788985178, 0.7936977547814076, 0.607493748157814, 0.7852215960400759, 0.7777407629871458, 0, 0.7203865358989782, 0.1691390509737191, 0.7653121187006996, 0.2721229478647714, 0.40701659936773116, 0.18154744213032242, 0.44123056667869864, 0.9322090762077303, 1, 1, 0.409400532290513, 0.977946327202094, 0.19934149152089142, 0.6044201254576205, 0.018541008673757103, 0.11769481959468758, 0.8254722326071635, 0.2518057381673458, 0.24630189439301528, 0.5274162042887102, 0.1515482893097751, 0.09799269454987661, 0.6155864505397228, 0.19055462327581227, 0, 0.7426153097949587, 0.07908183222147636, 0.08368061895852887, 0.8931432922928091, 0.9739740476513565, 0.6754348383608595, 0.27051247571833453, 0.15897869014407562, 0.40466581464626855, 0.8300626204177644, 0.5898794107677198, 0.4186073916765045, 0.4026155923353863, 0.8091099997447991, 0.4376033066542282, 0.37800672046372563, 0.6485104519103608, 0.6506343836538226, 0.6272945762995144, 0.03944367706774668, 0.19190433116282613, 0.3688569644261818, 0.5489881630797206, 0.15534178202582782, 0.44659173835447186, 0.8839970720255028, 0.572548336981654, 1, 1, 1, 0.17023371968650913, 0.510459688794258, 0, 0.46995480038641285, 0.54753748881452, 1, 0.7326868039880989, 1, 0.19508923263166658, 0.7177923412481253, 0.23686640895777286, 0.0873020993930782, 0.37718152035873787, 0.7264360475856282, 0.7812034025879631, 0, 0.5119508733107949, 0.5665545844285453, 0.5566559923729292, 0.19606782111335663, 0.7908492696248176, 0.24873951468392386, 0.7054395458105395, 0.5435942709930817, 0.51368566966858, 0.7579824517514581, 0.41094211974492384, 0.8792332169040014, 0, 0.7826502906761794, 0.5342581755122737, 0.6439698988255974, 0.5958662348821291, 0.7421867756685713, 0.9033625607291446, 0, 0.3343842418833197, 0.017202981187360633, 0.7500124015138787, 0.8936331845611097, 1, 0.4153419349892402, 0, 0, 0.49374197239898987, 0.3363206213410614, 0.15511932520397437, 0.46331567876095, 1, 0.5473025719376066, 0.14953369197392438, 0.8568725098210728, 0, 0.6497199288634882, 0.8397944387514181, 0.6500627623459767, 0.5477057584936577, 0.858535566591001, 0, 0.6162211601692371, 0, 0.5264242803439081, 0.47020105737527873, 0.4226950271389487, 0.71610230009305, 0.808984107092042, 0.5423757188545419, 1, 0.684615343943153, 0.32295294920732565, 0.23594009036686847, 0.9244125967541383, 0.18929631191590518, 0.6075524018685515, 0.5658678271751151, 0.7667046878132272, 0.2532145900765786, 0.3045180378983371, 0.8689267830003009, 0.9994372719613868, 0.7003150603712455, 0.17366003676883857, 0, 0.27451958856977826, 0.5626733158667149, 0.952644907106778, 0.34591396307673183, 1, 0.013324298241374233, 0.655635453645744, 0.45091262873654464, 0.41548606286354134, 0.9705262050601449, 0.7350414381469383, 0.5525968746258378, 0.19139333585321594, 0.8818285337950066, 0.37095373329171155, 0.8519945060593535, 0.043527319381573525, 0.9537658643711444, 0.342338036386994, 0.025325790832532433, 0.22502208797039347, 0.09021933847673677, 0.4894406183874601, 0.12674608895977227, 1, 0.426626677780496, 0.7398996441975351, 0.4755966554783584, 0.14848034683140832, 0.7381974316616298, 0.5082425286946187, 0.7092473470654832, 0.5282509390695608, 0.7968090590940049, 0.05752276528531072, 0.007956931359574884, 0.5555431837594033, 0, 0.2354220125211223, 0.16933308438319059, 0.9894364159958502, 0.9233257332159819, 0.8847618624516043, 0.1843901954939235, 0, 0, 0.6849009187300723, 0.3237651724222924, 0.2969044380754649, 0.003307965827018628, 0.8412341253269102, 0.9509491729800928, 0.9528419282760207, 1, 0.3355063307018029, 0.5409257815361223, 0.8520784050711567, 0.3118643798202075, 0.5565938511660175, 0, 0.9960709033448611, 0.31969660699523156, 0, 0, 0.6512024760724248, 0.6549062225713859, 0.9974433786054671, 0.07225008557143202, 0.12344309924604899, 0.8134755161763114, 0.649501385654059, 0.9549029171656376, 1, 1, 0.26915535601847784, 0.4503071421284943, 0.21004826096202864, 0.6299196391943024, 0.7343640938328275, 0.4698533797612708, 1, 0.19512286193795553, 0.08773005665615159, 0.6191855913047869, 0.5207822201275955, 0.9183184334447659, 0.56401696999367, 0.5356358924132704, 0, 0.5365209016187414, 0.23656984491121813, 0.28774284012281176, 0.10745598582031554, 0.4278221779048056, 0.5885571218639416, 1, 0.18068462536420693, 1, 0.09831460743381852, 0.2998426921958233, 0.2344802298750704, 0.5646793820553586, 0, 0.5415462394653621, 0.4971406052275106, 0.1329921782744004, 0.759747327260887, 0.45948037776877765, 0.8126054778656981, 0.16273389438922808, 0.8535494243066624, 0.40795334117119275, 0.7097267713175317, 0.3578384674221762, 0.503012848143943, 0.8668629574712726, 0.2982009650921493, 0.5435787460511999, 0.18860931922722832, 0.18983423485037157, 0.3480960708260528, 0.6233479800327546, 0.6025225272570572, 0, 1, 0.588185272690952, 0.813602435176133, 0.3197164631999677, 0.5552369288519232, 1, 0.21509449838803568, 0.929936612618515, 0.7493697970359251, 1, 0, 0.6561067499583407, 0.7387129466688431, 0.3015518365412503, 0.5848890976832243, 0.8767637220769562, 0.248142491461519, 0.33384968319811126, 0.30690508753245327, 1, 1, 0.11332794418256079, 0.6169837958103249, 1, 0.1023613881252287, 0.5963921752165224, 1, 0.7115579076789098, 0.7870894860025355, 0.5200073349884888, 0.3373136775534349, 0.5960451881255541, 0.375834647930812, 0.44324272517654767, 0.7082097765551744, 0.49624966748723526, 0, 1, 0.3729869531470226, 0.6381173978148164, 0.7954844425594244, 0.49287707744202625, 0.957410361854677, 0.5737531670670821, 0.9239107882942473, 0.13387585502368093, 0.29083810876101, 0.3565778154768875, 1, 0.4836451011042256, 0, 0.4962778482129666, 0.571524182415174, 0.10969573408379873, 0.3872645029940355, 0.21603842902792308, 0.9583588598584899, 0.33244403383334337, 0.7896708439978991, 0.5924335406977446, 0.9657342547983034, 0.6553698035994238, 0.4356751170925743, 0.7256209489679581, 0.3901799395344182, 0, 0.6317327492951609, 0.932687398998908, 0.2828782863785724, 0.31784056023797497, 0.5956154450787696, 0.5029158588586254, 0.23921962366804367, 0.16902452116878897, 0.5890667849158083, 0.04978740517134281, 0, 0.7360978090690692, 0.6146103615065359, 0.7882590110934085, 0, 0.2864638084315426, 0.8089015973968288, 0.5768609263384328, 0.15674542842445044, 0.045895073778748186, 0.744781458915207, 0.5066133714645513, 0.009145057310929267, 0, 0.19655468576333157, 0.8038774535166191, 0.6524166166621029, 0.9435994694343519, 1, 0.9208138446805321, 0.6824794493997687, 0.7792056891482413, 0.23300288313202905, 1, 0.6468821785554102, 0.19891685091341654, 0.1644408940912352, 1, 0.9692973941696803, 0, 0.7601204497011024, 0.17185824109019335, 1, 0.26370990075782647, 0.5637338737735211, 0.5505471452264697, 0.7302126191360567, 0.8898629440083355, 1, 0.06321550652884819, 0.6612642385528322, 0.2696469791525085, 0.7256011042851739, 0.4152726497885899, 0, 0.9319735109156708, 0.7479886495829462, 0.26245599119042246, 0, 0.9694052022619156, 0.2886851270142614, 0.4118779805341687, 0.27412485377586226, 0.7249434452187025, 0.08431882268540028, 0.9102581485897627, 0.4330180571652251, 0.7936881897345232, 0, 0.4184161358775845, 1, 0.32019174121097604, 0.14702937692066786, 0.11660969474169583, 0.2434509090185899, 0.6322140735284772, 0.24802290618924877, 0.9174526480775742, 0.21516285868110607, 1, 0.7492835557741948, 0.8882041523393175, 0.5708297877010593, 0.5999708022951642, 0.2629452650055166, 0.5371390558369786, 0.42017914554765723, 0.6569991077135634, 0.200205212710735, 0.5977210330494005, 0.30658511930098875, 0.8593099508089624, 1, 0.1714921178353445, 0.3315431062502131, 0.985355975640835, 0.7470256973270267, 0.2200198437786672, 0.2884380259107553, 0.7022696335751591, 1, 1, 0.870453446677115, 0.8989994189949618, 0.9264888277569292, 0.6456291869759261, 1, 0.8602411821240958, 0.25979326610189374, 0.47315703005210175, 0.568390248725458, 0.6785656843620955, 0.6806818963223279, 0.4760702935968276, 0.14385240865258997, 0.42219731032976876, 0.22420489401607452, 0.48232870225241503, 0.06547723892571042, 0.5163706655167956, 0.5565428283125377, 1, 0.5980693986099395, 0.9355821440114092, 0.18913547803000083, 0.26057407525365567, 0, 0.7145960519352803, 0.7510145503986791, 0.21767446843099147, 0.8461087208343453, 0.24195450864461857, 0, 0.7234081997812019, 0.6650115993597349, 0.8254470300548266, 0.3819739980421776, 0, 0.021977592516104642, 0.9339760941408648, 0, 0.5537630182590805, 1, 0.9386172467374901, 0, 0.5548760569041036, 0.28777986723193505, 0.659164981365362, 0.15678762553691264, 0.9302618092386447, 0.7528520754191438, 0, 0, 0.14498902187546941, 0.3542215075517471, 0, 0.5668502223597193, 0.08328677853399888, 0.8339645868219351, 1, 0.4834744396710395, 0.3182166171104038, 0.7473934476433637, 0.9484549890021408, 0, 0.5804956181962417, 0.710185161683359, 0.7618432071786547, 0.021387442075038968, 0, 1, 0.7382613946743828, 1, 0.5811863816750298, 0.4630166676731453, 0.12196538752585538, 1, 0, 0.26892308393268327, 0.4147721518407611, 0, 0.4955066162810736, 0.5997772801322705, 0.3769855537252733, 0.7028352679833529, 0.0001236789138135754, 0.2737256041718382, 0.7200882058826388, 0.5605956057106231, 0.5765759541593273, 0.3881504623363641, 0.15104621171929675, 0.12742488395487656, 1, 0.25465128278174115, 0.6009506612948378, 0.43312346147572994, 0.16743767292870748, 0.9022748347106015, 0.6493038015511542, 1, 0.4479641354513582, 0.6165737708114837, 0.3632269178980579, 0, 0.3881851319627615, 0.9928970018007531, 0.10212223037144652, 0.40641154690183856, 0.06956525642593317, 0.3139687598789691, 0, 0.1071008333773057, 1, 0.5587542252392304, 0.3573993439621113, 0.02259472640931738, 0.024248323130783695, 0.6888428903836844, 0.40293087149609963, 0.11710912595399653, 1, 1, 0.2532696646691815, 1, 0.4222005661162554, 0.31881068167676063, 0.4820915703869883, 0.6384882284538235, 1, 1, 0.3229676982675139, 0.0793782611919181, 0.15506940345502096, 0.6004035701088916, 0.3849893456247922, 0.41917433826902734, 0.9554720518126995, 0.07606207646586426, 0.3584453763249402, 0.7436574987620805, 0, 1, 0.7038797031034892, 1, 0, 0.08534223352155142, 0.5668744299582488, 0.398704481607235, 0.3118740466492719, 0.7065667513124388, 0.9484285053523035, 0.22747353643035007, 0.7881638872854473, 0, 0.7298218140940218, 0.659711061837099, 1, 0, 0.3838710538445681, 0.5297712907116346, 0.3087130878831239, 0.5279150109911956, 0.08037785237764974, 0.5285326620163857, 0.9602566039763235, 0.4833978177008018, 0.22834822084006062, 1, 0.10899205162541015, 0.05060696086359085, 0, 0, 0.2632435181637642, 0.7815538390617387, 0.5561169619956681, 0.2494181311187978, 0.21367185682640102, 0.9884689696991478, 0.5948406332112366, 0.9261240460304468, 0.3499898798697505, 0.39988678273564693, 0, 0.12977510532021547, 0.35110167496753797, 1, 0.42703809690145456, 0.3461713692373012, 0.44189363775879476, 0.805769510200425, 0.09381595320781204, 0.9573988596847837, 0.2869684083001026, 0, 0, 0.7291442704206371, 0.7484607014468262, 0.91053100059252, 0.4757716546956813, 0.7862267044392539, 0.6016802515948837, 0.6061944070553016, 0.9215758618571637, 0.6676297150155692, 0.9907418246914812, 0.7853574003669923, 0.6659109608306274, 0.39199163714686475, 0.14953769605948947, 0.9228068362713026, 0.23500180802974666, 0.7334905182910471, 0.14215652371299584, 0.5213968312290037, 0.12781629642915052, 0.38055954711309753, 0.06208018919768492, 0, 0.03815323700290907, 0.32694498226903923, 0.14146578768115806, 0.6953644800098001, 0.5134399387423323, 0.9345018563215709, 0.09813666796142656, 1, 0, 0.3843057391337823, 0, 0.8095993704488609, 0.021139789917247943, 0, 0.0483271262719194, 0.3319567095101751, 0.42711338893162476, 0.6782507855144514, 0.012722789081515903, 0, 0.5681950534219499, 0.46740074860300806, 0.2247951649847359, 0.32783824802700606, 0.8795385221106767, 0.6198523901843251, 0.3258379722491562, 0.30667536823007613, 0.8709300184589005, 0.2920382116000179, 0, 0.8082375314680297, 0.6982632959297146, 1, 0.5429108303821424, 0.5353133857504654, 0.04840422303233349, 0.2530628758121602, 0, 0.9572730958154303, 0.10118185695767229, 1, 0.06857528724744434, 0.7435424438262337, 0.3582926323726069, 0.4741990813143073, 0.7318359527569923, 0.031059524677464645, 0.5310168444412442, 0.25486818214724416, 0.27385001688820837, 0.7197812768116221, 0.0904802922537142, 0.4893382103728884, 0.5166667198469164, 0.8512995874445707, 0.32829367586340663, 0.6093130879211308, 1, 0.3893317685674502, 0.3377215270403233, 0.14566541231238103, 0.18671172929403707, 0.3409348514308822, 0, 0.16016936457200825, 0.5987266960486486, 0.4420098162598479, 0.4098017260891491, 0.7924699745177506, 0.6310722149206218, 0, 1, 0.44264163477163987, 0.06882584050275374, 0.4043686026230727, 0.5288915565224237, 0.08485165089512069, 0.415003737305351, 0.18043212385493224, 0.36492894872258225, 0.5359692523933202, 0.6828177733737619, 0.1343196374526129, 0.6744728812295455, 0.7505344905880331, 0.053393052686857345, 0.6678367701412399, 0.4528552528695383, 0, 0.3957059184426208, 1, 0.9152922655320859, 0.21065889304894236, 1, 0.580417884065837, 0.8572604172327943, 0.8696475628234686, 0.9739804926704375, 0, 0.1376626567907065, 0.9399492627354702, 0.7531711587083096, 0.1508896512004413, 1, 0.3539333969215331, 0.23562298914362417, 0.8117932654860812, 0.42609454553414006, 0.7384682029760915, 0, 0.6996471954741481, 0.31682708607586185, 0, 0.10306301538419238, 0.08012313042951835, 0.6048043516778233, 0.7090882485389405, 0.1130176685377381, 0.8660621749335528, 1, 0.967205316487443, 0, 0.44706996772035235, 0.24091042331044685, 1, 0.3914536574821684, 0.29524089044720936, 0.5831480423964214, 0.4813630711854675, 0.11411585617964431, 0.3533319699040909, 0.6045058516018805, 0.9253729973194129, 0.5986232215810519, 0.8133246102493261, 0.3519055488886816, 0.6760467297942082, 0.7430485418887939, 0.6408363220198755, 0.37600845735441984, 0.6880970209221702, 0.7124909550809773, 0, 0, 0.8155963587032187, 0.29401962830312134, 1, 0.10764546172723742, 0.6537938894764979, 0.1251211434647605, 0.06466927672518095, 0.37546212324618117, 0.5814550933995665, 1, 0.3573380066427611, 0.9811874353147434, 0.05647155284375766, 0.19335361769618847, 0.5259061341786373, 0.7440755153629608, 0.6249735450643458, 0.08937188813975103, 0.32232531222609434, 0.5919743797703491, 0.8958094720453987, 0.18445671639623498, 0.25699839210823766, 0.13795471295982917, 0, 0.7687617584417257, 0.7546940549705676, 0.27065242815798257, 1, 0.3450594231931242, 0.5516566217544514, 0.031054169044666652, 1, 0.6303051645344061, 0.25065453789165393, 0.2855277006186074, 0.6128577847377806, 0.15577759330527766, 0.10667209017463711, 0, 0.31900446608332605, 0.4521968406448291, 0.5711033728180372, 0.19813256934463389, 0.19634654739884283, 1, 1, 0.24907500905442814, 1]

        
        # data_filename = "Rule_Perm_Experiment_Final/data/permtestcsv_" + env_name_direct + "_" + str(num_agents) + "_agents.csv"
        
        #best_rule_perm = find_best_rule_perm(filename=data_filename, num_repetitions=num_repetitions)
        # best_rule_perm = [0, 4, 3, 2, 1, 5, 6]
        # #startpos, targetpos = generate_start_and_target_to_list(number_of_experiments=num_experiments , number_of_agents=num_agents, env=env)
        # startpos, targetpos =  generate_start_and_target_from_scenario("Scenario/" + env_name_direct + "-random-", num_agents)
        best_rule_perm = [0, 4, 3, 1, 5, 6, 2]
        # startpos, targetpos = generate_start_and_target_to_list(number_of_experiments=num_experiments , number_of_agents=num_agents, env=env)
        startpos, targetpos =  generate_start_and_target_from_scenario("Scenario/" + env_name_direct + "-random-", num_agents)
        best_cost_avg = []
        best_span_avg = []
        default_cost_avg = []
        default_span_avg = []
        best_failrate_avg = 0
        default_failrate_avg = 0
        i = 10

        for _ in range(i):
            best_cost, best_span, best_failrate = run_experiment(times=num_experiments, rule_order=best_rule_perm, chromosome=chromosome, startpos=startpos, targetpos=targetpos, environment=env, agents_amt=num_agents)
            default_cost, default_span, default_failrate = run_experiment(times=num_experiments, rule_order=best_rule_perm, chromosome=[], startpos=startpos, targetpos=targetpos, environment=env, agents_amt=num_agents)
            best_cost_avg.append(best_cost)
            best_span_avg.append(best_span)
            default_cost_avg.append(default_cost)
            default_span_avg.append(default_span)
            best_failrate_avg += best_failrate
            default_failrate_avg += default_failrate


        def flatten(l):
            return [item for sublist in l for item in sublist]

        best_cost = flatten(best_cost_avg)
        best_span = flatten(best_span_avg)
        default_cost = flatten(default_cost_avg)
        default_span = flatten(default_span_avg)
        best_failrate = best_failrate_avg/i
        default_failrate = default_failrate_avg/i

        print("best_cost_rule: ", best_rule_perm)
        print("cost of best rule order: ", sum(best_cost)/len(best_cost))
        print("span of best rule order: ", sum(best_span)/len(best_span))
        print("failrate of best rule order: ", best_failrate / num_experiments)
        print("cost of default rule order: ", sum(default_cost)/len(default_cost))
        print("span of default rule order: ", sum(default_span)/len(default_span))
        print("failrate of default rule order: ", default_failrate / num_experiments)

        # Conduct the one-way ANOVA
        print(f"Anova test for sum of costs for {env} map with {num_agents} agents")
        f_value, p_value = stats.f_oneway(best_cost, default_cost)
        print(f"f_value {f_value} and p_value {p_value}")

        # Conduct the one-way ANOVA
        print(f"Anova test for makespan for {env} map with {num_agents} agents")
        f_value, p_value = stats.f_oneway(best_span, default_span)
        print(f"f_value {f_value} and p_value {p_value}")

        print("Tukey HSD test on cost")
        print("0 is best_rule, 1 is default_rule")
        res = stats.tukey_hsd(best_cost, default_cost)
        print(res)

        print("Tukey HSD test on span")
        res = stats.tukey_hsd(best_span, default_span)
        print(res)

    

if __name__ == "__main__":
    main()





